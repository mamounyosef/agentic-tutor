# ==============================================================================
# AGENTIC TUTOR - Environment Configuration
# ==============================================================================

# Project Settings
APP_NAME=agentic_tutor
APP_ENV=development
DEBUG=true

# ==============================================================================
# DATABASE - MySQL (Separate for Constructor and Tutor workflows)
# ==============================================================================

# Constructor Database (Course Creators)
CONSTRUCTOR_DB_URL=mysql+pymysql://user:password@localhost:3306/agentic_tutor_constructor

# Tutor Database (Students)
TUTOR_DB_URL=mysql+pymysql://user:password@localhost:3306/agentic_tutor_tutor

# Connection Pool Settings
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30

# ==============================================================================
# LM Studio Local API - OpenAI Compatible
# Documentation: https://lmstudio.ai/docs/developer/core/server
# ==============================================================================

# LLM for Chat
LLM_BASE_URL=http://127.0.0.1:1234/v1
LLM_API_KEY=lm-studio
LLM_MODEL=gemma-3-270m-it
LLM_TEMPERATURE=0.7
LLM_MAX_TOKENS=4096

# Frontend API/WebSocket target (if running frontend separately)
# NEXT_PUBLIC_API_URL=http://localhost:8000
# NEXT_PUBLIC_WS_URL=ws://localhost:8000

# LangSmith Tracing (Cloud)
LANGSMITH_TRACING=true
LANGSMITH_API_KEY=
LANGSMITH_ENDPOINT=https://api.smith.langchain.com
LANGSMITH_PROJECT=agentic-tutor
LANGSMITH_WORKSPACE_ID=

# Embeddings
EMBEDDINGS_BASE_URL=http://127.0.0.1:1234/v1
EMBEDDINGS_API_KEY=lm-studio
EMBEDDINGS_MODEL=text-embedding-nomic-embed-text-v1.5
EMBEDDINGS_DIMENSIONS=768

# ==============================================================================
# VECTOR DATABASE - ChromaDB
# ==============================================================================

# Constructor Vector DB (Per Course)
CONSTRUCTOR_VECTOR_DB_PATH=./data/vector_db/constructor
CONSTRUCTOR_CHROMA_PERSIST_DIR=./data/vector_db/constructor/persistent

# Student Vector DBs (Per Student, Per Course)
STUDENT_VECTOR_DB_PATH=./data/vector_db/students

# Course Vector DBs (Read-Only for Students)
COURSE_VECTOR_DB_PATH=./data/vector_db/courses

# ChromaDB Settings
CHROMA_COLLECTION_CHUNK_SIZE=1000
CHROMA_COLLECTION_OVERLAP=200

# ==============================================================================
# LANGGRAPH CHECKPOINTERS (Conversation Memory)
# ==============================================================================

# Constructor Checkpointer
CONSTRUCTOR_CHECKPOINT_PATH=./checkpoints/constructor

# Tutor Checkpointer
TUTOR_CHECKPOINT_PATH=./checkpoints/tutor

# ==============================================================================
# JWT SECURITY
# ==============================================================================

SECRET_KEY=your-secret-key-generate-with-openssl-here
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_MINUTES=60

# ==============================================================================
# CORS
# ==============================================================================

CORS_ORIGINS=http://localhost:3000
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_HEADERS=["*"]

# ==============================================================================
# FILE STORAGE
# ==============================================================================

# Upload directories
UPLOAD_DIR=./uploads/materials
UPLOAD_PATH=../uploads
MAX_UPLOAD_SIZE=524288000  # 500MB
ALLOWED_EXTENSIONS=.pdf,.ppt,.pptx,.doc,.docx,.txt,.mp4,.mov,.avi,.mkv

# ==============================================================================
# VIDEO TRANSCRIPTION (faster-whisper with GPU)
# ==============================================================================

# Transcription service: whisper_local (GPU) or openai (API)
TRANSCRIPTION_SERVICE=whisper_local

# Model size for faster-whisper (balance speed vs accuracy)
# Options: tiny (fastest), base (fast, good), small (balanced), medium (accurate), large-v2/v3 (most accurate)
TRANSCRIPTION_MODEL_SIZE=base

# Device: cuda (GPU - RTX 4060) or cpu (fallback)
TRANSCRIPTION_DEVICE=cuda

# Compute type: float16 (GPU fast), int8 (CPU efficient), float32 (most accurate)
TRANSCRIPTION_COMPUTE_TYPE=float16

# Language: auto (detect) or specific code like "en", "es", "fr", etc.
TRANSCRIPTION_LANGUAGE=auto
TRANSCRIPTION_TIMEOUT_SECONDS=1200
TRANSCRIPTION_MAX_FILE_SIZE_MB=500
TRANSCRIPTION_MAX_DURATION_SECONDS=7200
TRANSCRIPTION_FFPROBE_TIMEOUT_SECONDS=30
TRANSCRIPTION_WORD_TIMESTAMPS=false
TRANSCRIPTION_MAX_SEGMENTS_METADATA=400

# OpenAI Whisper API (fallback option, requires API key)
TRANSCRIPTION_API_KEY=

# ==============================================================================
# LOGGING
# ==============================================================================

LOG_LEVEL=INFO
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_FILE=logs/app.log
LOG_ROTATION=midnight
LOG_RETENTION=7

# ==============================================================================
# COURSE SETTINGS
# ==============================================================================

# Default difficulty for new courses
DEFAULT_DIFFICULTY=beginner

# Session settings
DEFAULT_SESSION_LENGTH=30  # minutes
SESSION_MIN_LENGTH=10
SESSION_MAX_LENGTH=60

# Mastery settings
MASTERY_MIN_SCORE=0.7  # Topic mastery threshold
SPACED_REPETITION_DAYS=7  # Days before review needed

# Quiz settings
_QUIZ_QUESTIONS_PER_TOPIC=3
_QUIZ_PASSING_SCORE=0.6

# ==============================================================================
# RATE LIMITING
# ==============================================================================

# API Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000
